<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Healthy or Not?</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Figtree:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../shared/styles.css">
    <link rel="stylesheet" href="healthy.css">
</head>
<body>
    <!-- Background Animation -->
    <div class="background-animation" id="background-animation"></div>

    <!-- Main Container with Logo + Card -->
    <div class="main-container">
        <!-- Logo -->
        <div class="logo-container">
            <h1 class="game-logo">ğŸ Healthy or Not? ğŸ”</h1>
        </div>

        <!-- Game Card -->
        <div class="game-container">
            <div class="header">
                <h1>Is this healthy?</h1>
                <p class="subtitle">Learn about healthy and unhealthy foods!</p>
            </div>

            <div id="score-container"></div>

            <div id="game-play">
                <div class="guess-layout">
                    <div class="single-card food-card" id="food-card">
                        <div class="food-emoji" id="food-emoji">ğŸ</div>
                        <div class="food-name" id="food-name">Apple</div>
                    </div>

                    <div class="answer-options" id="answer-options">
                        <button class="answer-pill" onclick="makeGuess(true)">
                            Healthy
                        </button>
                        <button class="answer-pill" onclick="makeGuess(false)">
                            Unhealthy
                        </button>
                    </div>
                </div>

                <div class="feedback">
                    <div class="feedback-message" id="feedback"></div>
                </div>

                <button class="next-button" id="next-button" onclick="nextRound()"><span>Next Round â†’</span></button>
            </div>
        </div>

        <a href="../index.html" class="back-link">â† Back to Menu</a>
    </div>

    <script src="../shared/components.js"></script>
    <script>
        // Food items with educational information
        const foodItems = [
            // Healthy foods
            { emoji: 'ğŸ', name: 'Apple', healthy: true, info: 'Apples are full of vitamins and fiber!' },
            { emoji: 'ğŸ¥•', name: 'Carrot', healthy: true, info: 'Carrots help your eyes stay healthy!' },
            { emoji: 'ğŸ¥¦', name: 'Broccoli', healthy: true, info: 'Broccoli makes your body strong!' },
            { emoji: 'ğŸŒ', name: 'Banana', healthy: true, info: 'Bananas give you energy to play!' },
            { emoji: 'ğŸ“', name: 'Strawberry', healthy: true, info: 'Strawberries are sweet and healthy!' },
            { emoji: 'ğŸ¥¬', name: 'Lettuce', healthy: true, info: 'Lettuce is great in salads!' },
            { emoji: 'ğŸŠ', name: 'Orange', healthy: true, info: 'Oranges have lots of vitamin C!' },
            { emoji: 'ğŸ‡', name: 'Grapes', healthy: true, info: 'Grapes are a tasty, healthy snack!' },
            { emoji: 'ğŸ¥’', name: 'Cucumber', healthy: true, info: 'Cucumbers are crunchy and refreshing!' },
            { emoji: 'ğŸ…', name: 'Tomato', healthy: true, info: 'Tomatoes are vegetables that look like fruit!' },
            { emoji: 'ğŸ¥—', name: 'Salad', healthy: true, info: 'Salads are full of healthy vegetables!' },
            { emoji: 'ğŸ¥›', name: 'Milk', healthy: true, info: 'Milk helps build strong bones!' },
            { emoji: 'ğŸ¥œ', name: 'Peanuts', healthy: true, info: 'Peanuts have protein for strong muscles!' },
            { emoji: 'ğŸ‘', name: 'Peach', healthy: true, info: 'Peaches are juicy and nutritious!' },
            { emoji: 'ğŸ¥¥', name: 'Coconut', healthy: true, info: 'Coconuts have healthy fats!' },

            // Unhealthy foods
            { emoji: 'ğŸ”', name: 'Hamburger', healthy: false, info: 'Burgers are okay sometimes, but not every day!' },
            { emoji: 'ğŸŸ', name: 'French Fries', healthy: false, info: 'Fries have lots of salt and oil!' },
            { emoji: 'ğŸ•', name: 'Pizza', healthy: false, info: 'Pizza is yummy but has lots of cheese and oil!' },
            { emoji: 'ğŸ©', name: 'Donut', healthy: false, info: 'Donuts have too much sugar!' },
            { emoji: 'ğŸ°', name: 'Cake', healthy: false, info: 'Cake is a special treat, not everyday food!' },
            { emoji: 'ğŸª', name: 'Cookie', healthy: false, info: 'Cookies are sweet treats to enjoy rarely!' },
            { emoji: 'ğŸ«', name: 'Chocolate', healthy: false, info: 'Chocolate is delicious but full of sugar!' },
            { emoji: 'ğŸ¬', name: 'Candy', healthy: false, info: 'Candy can hurt your teeth if you eat too much!' },
            { emoji: 'ğŸ¥¤', name: 'Soda', healthy: false, info: 'Soda has way too much sugar!' },
            { emoji: 'ğŸ¦', name: 'Ice Cream', healthy: false, info: 'Ice cream is a special treat!' },
            { emoji: 'ğŸŒ­', name: 'Hot Dog', healthy: false, info: 'Hot dogs have lots of salt!' },
            { emoji: 'ğŸ§', name: 'Cupcake', healthy: false, info: 'Cupcakes are party treats!' },
            { emoji: 'ğŸ­', name: 'Lollipop', healthy: false, info: 'Lollipops are pure sugar!' },
            { emoji: 'ğŸ¥¨', name: 'Pretzel', healthy: false, info: 'Pretzels are very salty!' },
            { emoji: 'ğŸ§ƒ', name: 'Juice Box', healthy: false, info: 'Juice boxes often have added sugar!' }
        ];

        let currentFood = null;
        let streak = 0;
        let maxStreak = 0;
        let usedFoods = new Set();
        let autoAdvanceTimer = null;

        // Fun messages for different outcomes
        const correctMessages = [
            "â­ Amazing! You're right!",
            "ğŸ‰ Perfect! Great job!",
            "ğŸ‘ Excellent work!",
            "ğŸŒŸ You got it!",
            "ğŸ’š Fantastic!",
            "ğŸŠ Super smart!",
            "âœ¨ Well done!",
            "ğŸ† You're a health expert!",
            "ğŸ’ª Great choice!",
            "ğŸ¯ Spot on!"
        ];

        const incorrectMessages = [
            "ğŸ’­ Oops! Let's learn:",
            "ğŸ¤” Not quite! Here's why:",
            "ğŸ“š Let's discover:",
            "ğŸ’¡ Good try! Now you know:",
            "ğŸŒ± That's okay! Learn this:",
            "ğŸ“ Nice effort! Remember:",
            "ğŸ” Almost! Here's the truth:",
            "ğŸ“– Don't worry! Now you know:",
            "ğŸ§  Learning time:",
            "ğŸ’« Great guess! Actually:"
        ];

        function getRandomMessage(messages) {
            const randomIndex = Math.floor(Math.random() * messages.length);
            return messages[randomIndex];
        }

        function getRandomFood() {
            if (foodItems.length === 0) {
                console.error("No food items available");
                return null;
            }

            let attempts = 0;
            const maxAttempts = 100;

            while (attempts < maxAttempts) {
                const randomIndex = Math.floor(Math.random() * foodItems.length);
                const food = foodItems[randomIndex];

                if (!usedFoods.has(food.name)) {
                    usedFoods.add(food.name);
                    return food;
                }
                attempts++;
            }

            // If we've seen all foods, reset and return a new food
            usedFoods.clear();
            const randomIndex = Math.floor(Math.random() * foodItems.length);
            return foodItems[randomIndex];
        }

        function displayRound() {
            // Clear any existing auto-advance timer
            if (autoAdvanceTimer) {
                clearTimeout(autoAdvanceTimer);
                autoAdvanceTimer = null;
            }

            currentFood = getRandomFood();

            // Display food
            document.getElementById('food-emoji').textContent = currentFood.emoji;
            document.getElementById('food-name').textContent = currentFood.name;

            // Reset states
            document.getElementById('food-card').classList.remove('correct', 'incorrect', 'disabled', 'fade-out', 'fade-in');
            const pills = document.querySelectorAll('.answer-pill');
            pills.forEach(pill => {
                pill.classList.remove('disabled', 'correct', 'incorrect');
            });
            const feedback = document.getElementById('feedback');
            feedback.classList.remove('show', 'correct', 'incorrect');
            const nextButton = document.getElementById('next-button');
            nextButton.classList.remove('show', 'auto-advance');
        }

        function makeGuess(selectedHealthy) {
            const pills = document.querySelectorAll('.answer-pill');
            const feedback = document.getElementById('feedback');
            const nextButton = document.getElementById('next-button');
            const foodCard = document.getElementById('food-card');

            // Disable all pills
            pills.forEach(pill => pill.classList.add('disabled'));

            const isCorrect = selectedHealthy === currentFood.healthy;

            if (isCorrect) {
                streak++;
                if (streak > maxStreak) {
                    maxStreak = streak;
                }

                // Combine message and info
                feedback.innerHTML = `
                    <div>${getRandomMessage(correctMessages)}</div>
                    <div style="margin-top: 0.5rem;">${currentFood.info}</div>
                `;
                feedback.classList.add('show', 'correct');
                foodCard.classList.add('correct');

                // Highlight correct pill (get pills as array and check by index)
                const pillsArray = Array.from(pills);
                const selectedIndex = selectedHealthy ? 0 : 1;
                pillsArray[selectedIndex].classList.add('correct');
            } else {
                streak = 0;

                // Combine message and info
                feedback.innerHTML = `
                    <div>${getRandomMessage(incorrectMessages)}</div>
                    <div style="margin-top: 0.5rem;">${currentFood.info}</div>
                `;
                feedback.classList.add('show', 'incorrect');
                foodCard.classList.add('incorrect');

                // Highlight correct and incorrect pills
                const pillsArray = Array.from(pills);
                const selectedIndex = selectedHealthy ? 0 : 1;
                const correctIndex = currentFood.healthy ? 0 : 1;
                pillsArray[selectedIndex].classList.add('incorrect');
                pillsArray[correctIndex].classList.add('correct');
            }

            // Update score display
            document.getElementById('streak').textContent = streak;
            document.getElementById('max-streak').textContent = maxStreak;

            // Show next button with auto-advance
            nextButton.classList.add('show');

            // Start auto-advance timer and animation
            setTimeout(() => {
                nextButton.classList.add('auto-advance');
            }, 10);

            autoAdvanceTimer = setTimeout(() => {
                nextRound();
            }, 3500);
        }

        function nextRound() {
            // Fade out current content
            const guessLayout = document.querySelector('.guess-layout');
            const feedback = document.getElementById('feedback');
            const nextButton = document.getElementById('next-button');

            guessLayout.classList.add('fade-out');
            feedback.classList.add('fade-out');
            nextButton.classList.add('fade-out');

            // Wait for fade out animation, then load new round
            setTimeout(() => {
                // Remove fade-out classes
                feedback.classList.remove('fade-out');
                nextButton.classList.remove('fade-out');

                displayRound();

                // Fade in new content
                setTimeout(() => {
                    guessLayout.classList.remove('fade-out');
                    guessLayout.classList.add('fade-in');

                    // Remove animation class after animation completes
                    setTimeout(() => {
                        guessLayout.classList.remove('fade-in');
                    }, 400);
                }, 50);
            }, 300);
        }

        // Initialize game
        displayRound();
    </script>
</body>
</html>
